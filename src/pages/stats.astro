---
import NavBar from "../components/NavBar.astro";
import Layout from "../layouts/Layout.astro";
---

<Layout title="Stats | IS Manager">
    <main class="col">
        <NavBar title="Stats" origin="home"/>
        <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 px-[1rem] overflow-hidden">
            <div id="chart"></div>
            <div id="chartGlobal"></div>
            <div id="chartAnnual"></div>
            <div id="chartPeriods"></div>
        </div>
    </main>
</Layout>
<script is:inline type="module">
    const rem = remaining.length;
    const total = career.classes.length;
    const passed = past.length;

    //PROGRESS
    var options = {
        series: [passed/total*100, rem/total*100],
        labels: ['Passed', 'Remaining'],
        chart: {
            type: 'donut',
        },
        plotOptions: {
            pie: {
                donut: {
                    labels: {
                        show: true,
                        name: {
                            show: true,
                            offsetY: -20,
                            formatter: function (val) {
                                return val;
                            }
                        },
                        value: {
                            show: true,
                            offsetY: 10,
                            formatter: function (val) {
                                return parseInt((val/100)*total) + " Classes";
                            }
                        },
                        total: {
                            show: true,
                            label: 'Progress',
                            formatter: function (w) {
                                return `${passed+'/'+total} Classes`
                            }
                        }
                    }
                }
            }
        },
        colors: ['#FF4500', '#FFA500'],
        stroke: {
            width: 0, // Elimina el borde blanco
        },
        legend: {
            position: 'bottom',
            horizontalAlign: 'center',
            offsetY: 10
        }
    };

    var chart = new ApexCharts(document.querySelector("#chart"), options);
    chart.render();
    //GLOBAL
    var optionsGlobal = {
          series: [{
          name: 'Global',
          data: [31, 40, 28, 51, 42, 65, 100]
        }],
          chart: {
          height: 350,
          type: 'area'
        },
        dataLabels: {
          enabled: false
        },
        stroke: {
          curve: 'smooth'
        },
        xaxis: {
          type: 'datetime',
          categories: ["2018-09-19T00:00:00.000Z", "2018-09-19T01:30:00.000Z", "2018-09-19T02:30:00.000Z", "2018-09-19T03:30:00.000Z", "2018-09-19T04:30:00.000Z", "2018-09-19T05:30:00.000Z", "2018-09-19T06:30:00.000Z"]
        },
        };

    var chartGlobal = new ApexCharts(document.querySelector("#chartGlobal"), optionsGlobal);
    chartGlobal.render();

    //ANNUAL
    var optionsAnnual = {
          series: [
          {
            name: "Year",
            data: [28, 29, 33, 36, 32, 32, 33]
          }
        ],
          chart: {
          height: 350,
          type: 'line',
          dropShadow: {
            enabled: true,
            color: '#000',
            top: 18,
            left: 7,
            blur: 10,
            opacity: 0.2
          },
          zoom: {
            enabled: false
          },
          toolbar: {
            show: false
          }
        },
        colors: ['#77B6EA'],
        dataLabels: {
          enabled: true,
        },
        stroke: {
          curve: 'smooth'
        },
        title: {
          text: 'Average Annual',
          align: 'left'
        },
        grid: {
          borderColor: '#e7e7e7',
          row: {
            colors: ['transparent', 'transparent'],
            opacity: 0.5
          },
        },
        markers: {
          size: 1
        },
        xaxis: {
          categories: ['2020', '2021', '2022', '2023', '2024', '2025', '2026'],
          title: {
            text: 'Year'
          }
        },
        legend: {
          position: 'top',
          horizontalAlign: 'right',
          floating: true,
          offsetY: -25,
          offsetX: -5
        }
        };

    var chartAnnual = new ApexCharts(document.querySelector("#chartAnnual"), optionsAnnual);
    chartAnnual.render();

    //PERIODS
    var optionsPeriods = {
          series: [{
          name: 'Net Profit',
          data: [44, 55, 57, 56, 61, 58, 63, 60, 66]
        }, {
          name: 'Revenue',
          data: [76, 85, 101, 98, 87, 105, 91, 114, 94]
        }, {
          name: 'Free Cash Flow',
          data: [35, 41, 36, 26, 45, 48, 52, 53, 41]
        }],
          chart: {
          type: 'bar',
          height: 350
        },
        plotOptions: {
          bar: {
            horizontal: false,
            columnWidth: '55%',
            endingShape: 'rounded'
          },
        },
        dataLabels: {
          enabled: false
        },
        stroke: {
          show: true,
          width: 2,
          colors: ['transparent']
        },
        xaxis: {
          categories: ['Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'],
        },
        fill: {
          opacity: 1
        },
        tooltip: {
          y: {
            formatter: function (val) {
              return "$ " + val + " thousands"
            }
          }
        }
        };

    var chartPeriods = new ApexCharts(document.querySelector("#chartPeriods"), optionsPeriods);
    chartPeriods.render();
      
    //TODO: Add more Charts

</script>